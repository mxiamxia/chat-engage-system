var app=angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","angularUtils.directives.dirPagination","LocalStorageModule"]);app.config(["localStorageServiceProvider",function(a){a.setPrefix("coengage")}]);
"use strict";app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,l){e.otherwise("/"),l.html5Mode(!0),t.state("index",{url:"/",templateUrl:"templates/login.html",controller:"login-ctrl"}).state("register",{url:"/register",templateUrl:"templates/register.html"}).state("layout",{url:"/main","abstract":!0,templateUrl:"templates/layout.html"}).state("layout.dashboard",{url:"/dashboard",params:{username:{}},views:{dashboard:{templateUrl:"templates/dashboard.html"}}}).state("layout.tables",{url:"/tables",views:{table:{templateUrl:"templates/tables.html"}}})}]);
function AlertsCtrl(e){e.alerts=[{type:"success",msg:"Thanks for visiting! Feel free to create pull requests to improve the dashboard!"},{type:"danger",msg:"Found a bug? Create an issue with as many details as you can."}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.closeAlert=function(t){e.alerts.splice(t,1)}}angular.module("RDash").controller("AlertsCtrl",["$scope",AlertsCtrl]);
function LoginController(r,o,e){r.input={username:"",password:""},r.login=function(){e.authenticate(r.input.username,r.input.password).success(function(e){e?e.auth?(r.loginerror=!1,o.go("layout.dashboard",{username:r.input.username})):(r.loginerror=!0,r.errdetail="The username or password is not correct"):(r.loginerror=!0,r.errdetail="Login fail!")}).error(function(o){r.loginerror=!0,r.errdetail="Your account does not exist in Mattermost"})}}app.controller("login-ctrl",["$scope","$state","authService",LoginController]);
function MasterCtrl(e,o,n,s,t){var r=992;e.sessionData=[],e.currentSession=[],e.searchText={text:""},e.search={text:""},e.sessionOfToday=0,e.engageOfToday=0,0!==Object.keys(n.username).length&&t.set("username",n.username),e.loginname=t.get("username"),e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(n,s){n>=r?angular.isDefined(o.get("toggle"))?e.toggle=!!o.get("toggle"):e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,o.put("toggle",e.toggle)},window.onresize=function(){e.$apply()};var i=function(){s.getHistorySession().success(function(o){e.sessionData=o}).error(function(e){console.log("Error: "+e)})},c=function(){s.getCurrentSessions().success(function(o){console.log("current session length="+o[0]),e.currentSession=o}).error(function(e){console.log("Error: "+e)})};e.refreshSessions=function(){s.getHistorySession().success(function(o){e.sessionData=o}).error(function(e){console.log("Error: "+e)})},e.deleteSession=function(o){console.log("delete session="+o),s.deleteSession(o).success(function(o){1e3===o.code&&(console.log("cur session length"+e.currentSession.length),e.currentSession.splice(e.currentSession.indexOf(o.id),1),console.log("cur session length1"+e.currentSession.length))}).error(function(e){console.log("Error: "+e)})},e.refreshCurrentSessions=function(){c()};var g=function(){s.getSessionOfToday().success(function(o){e.sessionOfToday=o.number}).error(function(e){console.log("Error: "+e)})};e.getSessionOfToday=function(){g()};var u=function(){s.getEngageOfToday().success(function(o){e.engageOfToday=o.number}).error(function(e){console.log("Error: "+e)})};e.getEngageOfToday=function(){u()};var l=function(){c(),i(),g(),u()};l()}app.controller("MasterCtrl",["$scope","$cookieStore","$stateParams","Session","localStorageService",MasterCtrl]);
function RegisterController(r){function e(){}var t=this;t.register=e}app.controller("register-ctrl",["$scope",RegisterController]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-5" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);
function Auth(t){return{authenticate:function(a,e){var u={email:a,password:e},r={method:"post",url:"/api/authenticate",data:u};return t(r)}}}app.factory("authService",["$http",Auth]);
app.factory("Session",["$http",function(e){return{getActiveSessions:function(){var t={method:"GET",url:"/api/getActiveSession"};return e(t)},getHistorySession:function(){var t={method:"GET",url:"/api/getHistorySession"};return e(t)},getCurrentSessions:function(){var t={method:"GET",url:"/api/getAllSessionKey"};return e(t)},deleteSession:function(t){var n={sessionId:t},o={method:"POST",url:"/api/deleteSession",data:n};return e(o)},getSessionOfToday:function(){var t={method:"GET",url:"/api/getTodaySession"};return e(t)},getEngageOfToday:function(){var t={method:"GET",url:"/api/getTodayEngage"};return e(t)}}}]);