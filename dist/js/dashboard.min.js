var app=angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","angularUtils.directives.dirPagination","LocalStorageModule"]);app.run(["$rootScope","$location","authService","$state",function(o,e,a,i){o.$on("$stateChangeStart",function(o,e,t,n,r){return"index"!=e.name?a.isLogin()?void 0:(o.preventDefault(),void i.go("index")):a.isLogin()?(o.preventDefault(),void i.go("layout.dashboard")):void 0})}]),app.config(["localStorageServiceProvider",function(o){o.setPrefix("coengage")}]);
"use strict";app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,l){e.otherwise("/"),l.html5Mode(!0),t.state("index",{url:"/",templateUrl:"templates/login.html",controller:"login-ctrl"}).state("register",{url:"/register",templateUrl:"templates/register.html"}).state("layout",{url:"/main","abstract":!0,templateUrl:"templates/layout.html"}).state("layout.dashboard",{url:"/dashboard",params:{username:{}},views:{dashboard:{templateUrl:"templates/dashboard.html"}}}).state("layout.tables",{url:"/tables",views:{table:{templateUrl:"templates/tables.html"}}})}]);
function AlertsCtrl(e){e.alerts=[{type:"success",msg:"Thanks for visiting! Feel free to create pull requests to improve the dashboard!"},{type:"danger",msg:"Found a bug? Create an issue with as many details as you can."}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.closeAlert=function(t){e.alerts.splice(t,1)}}angular.module("RDash").controller("AlertsCtrl",["$scope",AlertsCtrl]);
function LoginController(r,e,o){r.input={username:"",password:""},r.login=function(){o.authenticate(r.input.username,r.input.password).success(function(n){n?n.auth?(r.loginerror=!1,o.setLoginStatus({user:r.input.username}),e.go("layout.dashboard",{username:r.input.username})):(r.loginerror=!0,r.errdetail="The username or password is not correct"):(r.loginerror=!0,r.errdetail="Login fail!")}).error(function(e){r.loginerror=!0,r.errdetail="Your account does not exist in Mattermost"})}}app.controller("login-ctrl",["$scope","$state","authService",LoginController]);
function MasterCtrl(e,o,n,s,t,r){var i=992;e.sessionData=[],e.currentSession=[],e.searchText={text:""},e.search={text:""},e.sessionOfToday=0,e.engageOfToday=0,r.isLogin()&&(e.loginname=t.cookie.get("username").user),e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(n,s){n>=i?angular.isDefined(o.get("toggle"))?e.toggle=!!o.get("toggle"):e.toggle=!0:e.toggle=!1}),e.toggleSidebar=function(){e.toggle=!e.toggle,o.put("toggle",e.toggle)},window.onresize=function(){e.$apply()};var c=function(){s.getHistorySession().success(function(o){e.sessionData=o}).error(function(e){console.log("Error: "+e)})},g=function(){s.getCurrentSessions().success(function(o){console.log("current session length="+o[0]),e.currentSession=o}).error(function(e){console.log("Error: "+e)})};e.refreshSessions=function(){s.getHistorySession().success(function(o){e.sessionData=o}).error(function(e){console.log("Error: "+e)})},e.deleteSession=function(o){s.deleteSession(o).success(function(o){1e3===o.code&&(console.log("cur session length"+e.currentSession.length),e.currentSession.splice(e.currentSession.indexOf(o.id),1),console.log("cur session length1"+e.currentSession.length))}).error(function(e){console.log("Error: "+e)})},e.refreshCurrentSessions=function(){g()};var u=function(){s.getSessionOfToday().success(function(o){e.sessionOfToday=o.number}).error(function(e){console.log("Error: "+e)})};e.getSessionOfToday=function(){u()};var l=function(){s.getEngageOfToday().success(function(o){e.engageOfToday=o.number}).error(function(e){console.log("Error: "+e)})};e.getEngageOfToday=function(){l()};var a=function(){g(),c(),u(),l()};a(),e.logout=function(){r.logout(),n.go("index")}}app.controller("MasterCtrl",["$scope","$cookieStore","$state","Session","localStorageService","authService",MasterCtrl]);
function RegisterController(r){function e(){}var t=this;t.register=e}app.controller("register-ctrl",["$scope",RegisterController]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-5" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("RDash").directive("rdWidget",rdWidget);
function Auth(e,t){return{authenticate:function(t,o){var n={email:t,password:o},u={method:"post",url:"/api/authenticate",data:n};return e(u)},isLogin:function(){return"undefined"!==t.cookie.get("username")&&null!==t.cookie.get("username")},setLoginStatus:function(e){t.cookie.set("username",e,7)},logout:function(){console.log("logout user"),t.cookie.remove("username")}}}app.factory("authService",["$http","localStorageService",Auth]);
app.factory("Session",["$http",function(e){return{getActiveSessions:function(){var t={method:"GET",url:"/api/getActiveSession"};return e(t)},getHistorySession:function(){var t={method:"GET",url:"/api/getHistorySession"};return e(t)},getCurrentSessions:function(){var t={method:"GET",url:"/api/getAllSessionKey"};return e(t)},deleteSession:function(t){var n={sessionId:t},o={method:"POST",url:"/api/deleteSession",data:n};return e(o)},getSessionOfToday:function(){var t={method:"GET",url:"/api/getTodaySession"};return e(t)},getEngageOfToday:function(){var t={method:"GET",url:"/api/getTodayEngage"};return e(t)}}}]);